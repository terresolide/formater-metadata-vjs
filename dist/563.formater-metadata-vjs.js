(self.webpackChunkformater_metadata_vjs=self.webpackChunkformater_metadata_vjs||[]).push([[563],{6887:e=>{e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"en":{"accept":"I accept the terms of use by signing &laquo;{charter}&raquo;","already_signed":"You have already signed &laquo;{charter}&raquo;!","need_idp":"For sign a charter, you must connect with one of the identity providers (Orcid or Edugain)","need_log":"You must login to access this page!","new_roles":"New roles have been assigned to you: {newroles}<br>Log out/log in for them to take effect!","no_charter":"No charter match!","sign_charter":"Sign the &laquo;{charter}&raquo;","sign_saved":"Your signature has been saved."},"fr":{"accept":"J\'accepte les conditions d\'utilisation en signant  &laquo;{charter}&raquo;","already_signed":"Vous avez déjà signé &laquo;{charter}&raquo;!","need_idp":"Pour signer cette charte, vous devez vous connecter avec l\'un des fournisseurs d\'identité (Orcid ou Edugain)","need_log":"Vous devez vous connecter pour accéder à cette page!","new_roles":"De nouveaux roles vous ont été attribués: {newroles}<br>Déconnectez-vous/reconnectez-vous pour qu\'ils soient pris en compte!","no_charter":"Aucune charte ne correspond!","sign_charter":"Signer &laquo;{charter}&raquo;","sign_saved":"Votre signature a bien été enregistrée."}}'),delete e.options._Ctor}},4745:(e,t,r)=>{var s=r(3645),n=r(1667),a=r(1235);t=s(!1);var i=n(a);t.push([e.id,"\ndiv.warning[data-v-bd0c36b0] {\n  border: 2px solid darkred;\n  border-radius: 5px;\n  padding: 10px;\n  color: darkred;\n  font-weight:700;\n  margin: 10px 0;\n}\ndiv.warning span[data-v-bd0c36b0] {\n  display:inline-block;\n  width:calc(100% - 60px);\n  margin-left:10px;\n}\ndiv.warning i[data-v-bd0c36b0] {\n  vertical-align:top;\n  margin-top:5px;\n}\n.blurry-background[data-v-bd0c36b0]{\n   background: url("+i+") no-repeat center center fixed;\n   width:100%;\n   min-height:500px;\n   height:100vh;\n   padding: 30px;\n   -webkit-background-size: cover;\n  -moz-background-size: cover;\n  -o-background-size: cover;\n  background-size: cover;\n  text-align: center;\n}\n.connect-msg[data-v-bd0c36b0] {\n  background: rgba(255,255,255,0.5);\n  padding: 50px;\n  max-width:450px;\n  border-radius: 10px;\n  margin: 5% auto;\n  border:none;\n}\n.form-charter[data-v-bd0c36b0] {\n   margin: 10px 0;\n   padding:10px;\n   border:1px dotted grey;\n}\n.mtdt-charter[data-v-bd0c36b0] {\n  border-top: 1px dotted grey;\n}\ndiv.charter-view[data-v-bd0c36b0] {\n  max-width: 900px;\n  margin:auto;\n}\n",""]),e.exports=t},1235:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});const s=r.p+"assets/img/background-sign.847319b.png"},4659:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});const s={name:"FormaterCharter",components:{FormaterPdfViewer:r(9205).Z},data:function(){return{src:null,title:null,accept:!1,alreadySigned:!0,searching:!1,success:!1,newRoles:[]}},computed:{email:function(){return this.getCharter(this.id),this.$store.getters["user/email"]},user:function(){return this.$store.getters["user/get"]},identityProvider:function(){return this.user?this.user.identityProvider:null},id:function(){return this.$route.params.id}},created:function(){this.$store.commit("services/resetCurrent"),this.$store.commit("user/toggleShow",null)},mounted:function(){this.getCharter(this.id)},destroyed:function(){},methods:{check:function(e){if(!e.error&&e.success){this.success=!0,this.$store.commit("charters/addSigned",this.id);var t=this;e.roles.forEach((function(e){"ACCEPTED"===e.status&&t.newRoles.push(e.name),t.$store.commit("roles/setStatus",e)}))}},getCharter:function(e){var t=this;if(this.reset(),this.user){var r=this.$store.state.checkSSO+"/charters/get";r+="?userId="+this.user.id+"&charterId="+this.$route.params.id+"&lang="+this.$store.state.lang,this.$http.get(r).then((function(e){e.body&&t.initialize(e.body)}))}},initialize:function(e){e.error||(this.accept=e.userId,this.alreadySigned=this.accept,this.success=!1,this.title=e.title,this.src=e.url)},reset:function(){this.accept=null,this.alreadySigned=!0,this.title="---",this.src=null},send:function(){var e=this;if(this.user&&this.accept){this.searching=!0;var t=this.$custURL(window.location.href),r=this.$store.state.checkSSO+"/charters/sign";this.$http.post(r,{userId:this.user.id,email:this.email,app:"catalog",realm:this.$store.getters["user/realm"],charterId:this.$route.params.id,domain:t.base+"#/",lang:this.$store.state.lang,url:window.location.href},{emulateJSON:!0}).then((function(t){e.searching=!1,t.body&&e.check(t.body)}),(function(t){e.searching=!1}))}}}};r(5928);var n=r(1900),a=r(6887);const i=r.n(a)();var c=(0,n.Z)(s,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"mtdt-charter"},[e.email?e.src?t("div",{staticClass:"charter-view"},[t("h2",{domProps:{innerHTML:e._s(e.$t("sign_charter",{charter:e.title}))}}),e._v(" "),t("div",{staticStyle:{"text-align":"center"}},[t("a",{attrs:{href:e.src,target:"_blank"}},[t("i",{staticClass:"fa fa-file"}),e._v(" "+e._s(e.title))])]),e._v(" "),t("formater-pdf-viewer",{attrs:{src:e.src,lang:e.$store.state.lang,fa:!0}}),e._v(" "),e.identityProvider||e.alreadySigned?e._e():t("div",{staticClass:"warning"},[t("i",{staticClass:"fa fa-exclamation-triangle"}),e._v(" "),t("span",[e._v(e._s(e.$t("need_idp")))])]),e._v(" "),t("div",{staticClass:"form-charter"},[e.alreadySigned?t("div",{staticStyle:{color:"darkred"},domProps:{innerHTML:e._s(e.$t("already_signed",{charter:e.title}))}}):e._e(),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.accept,expression:"accept"}],attrs:{type:"checkbox",disabled:!e.identityProvider||e.alreadySigned||e.searching||e.success,required:""},domProps:{checked:Array.isArray(e.accept)?e._i(e.accept,null)>-1:e.accept},on:{change:function(t){var r=e.accept,s=t.target,n=!!s.checked;if(Array.isArray(r)){var a=e._i(r,null);s.checked?a<0&&(e.accept=r.concat([null])):a>-1&&(e.accept=r.slice(0,a).concat(r.slice(a+1)))}else e.accept=n}}}),e._v(" "),t("span",{domProps:{innerHTML:e._s(e.$t("accept",{charter:e.title}))}}),e._v(" "),e.success?t("div",{staticStyle:{color:"green"},domProps:{innerHTML:e._s(e.$t("sign_saved",{charter:e.title}))}}):e._e(),e._v(" "),e.success&e.newRoles.length>0?t("div",{staticStyle:{color:"green"},domProps:{innerHTML:e._s(e.$t("new_roles",{newroles:e.newRoles.join(",")}))}}):e._e(),e._v(" "),t("div",{staticStyle:{margin:"20px","text-align":"right"}},[t("input",{attrs:{type:"button",value:"Enregistrer",disabled:!e.identityProvider||e.alreadySigned||e.searching||e.success},on:{click:e.send}})])])],1):t("div",{staticClass:"blurry-background"},[t("div",{staticClass:"connect-msg",style:{color:e.$store.state.style.primary}},[e._v(e._s(e.$t("no_charter")))])]):t("div",{staticClass:"blurry-background"},[t("div",{staticClass:"connect-msg",style:{color:e.$store.state.style.primary}},[e._v(" "+e._s(e.$t("need_log"))+" ")])])])}),[],!1,null,"bd0c36b0",null);"function"==typeof i&&i(c);const o=c.exports},5928:(e,t,r)=>{var s=r(4745);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals),(0,r(5346).Z)("c54b9f7e",s,!0,{})},172:()=>{},2001:()=>{},3779:()=>{},2258:()=>{}}]);
//# sourceMappingURL=563.formater-metadata-vjs.js.map
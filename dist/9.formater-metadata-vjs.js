(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{262:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"searching":"Searching"},"fr":{"searching":"Recherche en cours"}}'),delete t.options._Ctor}},348:function(t,e,a){"use strict";var s=a(262),i=a.n(s);e.default=i.a},380:function(t,e,a){"use strict";a.r(e);var s=a(284),i=a(285),n=a(287),r=a(288),o=a(48);function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var u={name:"FormaterSingle",components:{FormaterDrawBbox:r.a,FormaterForm:s.a,FormaterListMetadata:i.default,FormaterMetadata:function(){return a.e(1).then(a.bind(null,377))},FormaterPaging:n.default,AerisTheme:o.a},data:function(){return{metadata:null,uuid:null,first:!0,sortBy:"",metaDisplayed:null,previousRoute:null,metadataListener:null,drawing:!1,aerisSearchListener:null,aerisResetListener:null,backListener:null,temporalExtent:{min:"1900-01-01",max:"now"},previousRoutes:[]}},watch:{$route:function(t,e){this.uuid=t.params.uuid,this.$store.getters.previousRoute.params.uuid===this.uuid&&this.$store.commit("backChild"),this.getMetadata()}},created:function(){this.uuid=this.$route.params.uuid,this.getMetadata(),this.$route.query.sortBy?this.sortBy=this.$route.query.sortBy:this.sortBy=this.$store.state.orderBy,this.initTemporalExtent(),this.keydownListener=this.checkEscape.bind(this),document.addEventListener("keydown",this.keydownListener)},mounted:function(){},destroyed:function(){document.removeEventListener("aerisSearchEvent",this.aerisSearchListener),this.aerisSearchListener=null,document.removeEventListener("aerisResetEvent",this.aerisResetListener),this.aerisResetListener=null},methods:{getFileMetadata:function(){var t=this;this.$http.get(this.$store.state.metadata).then((function(e){t.treatmentSingle(e.body)}))},getMetadata:function(){var t=this;if(this.$store.state.metadata)this.getFileMetadata();else{var e={Accept:"application/json, text/plain, */*","Accept-Language":"fr"===this.$store.state.lang?"fre":"eng"},a=this.$store.state.geonetwork+"srv/"+("fr"===this.$i18n.locale?"fre":"eng")+"/";a+="q?fast=index&bucket=s101&resultType=step1&_content_type=json&uuid="+this.uuid,this.$http.get(a,{headers:e}).then((function(e){t.treatmentMeta(e.body)}),(function(t){console.log(t.body)}))}},treatmentSingle:function(t){var e=t["geonet:info"].uuid;this.metadata=this.$gn.treatmentMetadata(t,e);var a=this.$gn.extractBbox(t.geoBox,e);this.$router.replace({name:this.$route.name,params:{uuid:e},query:this.$route.query});var s=new CustomEvent("fmt:metadataEvent",{detail:{meta:this.metadata,feature:a}});document.dispatchEvent(s)},treatmentMeta:function(t){this.metadata=this.$gn.treatmentMetadata(t.metadata,this.uuid);var e=this.$gn.extractBbox(t.metadata.geoBox,this.uuid),a=new CustomEvent("fmt:metadataEvent",{detail:{meta:this.metadata,feature:e}});document.dispatchEvent(a)},initTemporalExtent:function(){this.$store.state.temporalExtent&&this.$store.state.temporalExtent.min&&(this.temporalExtent.min=this.$store.state.temporalExtent.min),this.$store.temporalExtent&&this.$store.temporalExtent.max&&(this.temporalExtent.max=this.$store.temporalExtent.max)},closeSingle:function(){var t=new CustomEvent("fmt:closeMetadataEvent",{detail:{depth:2}});document.dispatchEvent(t),this.$store.commit("resetSelectedMetadata")},receiveMetadata:function(t){this.$store.state.metadata&&this.first&&(this.first=!1,this.metadataUui=t.detail.meta.id),this.currentUuid=t.detail.meta.id,this.$store.commit("currentUuidChange",this.currentUuid);var e=null,a=null,s=0;if("string"==typeof t.detail.meta.tempExtentBegin)e=t.detail.meta.tempExtentBegin.substring(0,10),s=1;else if("object"===m(t.detail.meta.tempExtentBegin)){var i=t.detail.meta.tempExtentBegin.map((function(t){return t.substring(0,10)}));i.sort(),e=i[0],s=i.length}if("string"==typeof t.detail.meta.tempExtentEnd&&1===s)a=t.detail.meta.tempExtentEnd.substring(0,10);else if("object"===m(t.detail.meta.tempExtentEnd)&&t.detail.meta.tempExtentEnd.length===s){var n=t.detail.meta.tempExtentEnd.map((function(t){return t.substring(0,10)}));n.sort(),a=n[n.length-1]}var r={min:e||this.temporalExtent.min,max:a||this.temporalExtent.max};this.$store.commit("temporalChange",r)},close:function(){var t=this.$store.getters.previousRoute;this.$router.push({name:t.name,params:t.params,query:t.query}),this.$store.commit("services/resetCurrent"),this.$store.commit("backChild")},back:function(){},checkEscape:function(t){var e=t||window.event;(e.key?"Escape"===e.key||"Esc"===e.key:27===e.keyCode)&&this.$router.go(-1)},setParameters:function(t){this.$store.commit("parametersChange",{parameters:t.osParameters,mapping:t.mapping,type:t.type})},closeError:function(){this.$store.commit("removeError")}}},d=a(1),c=a(348),l=Object(d.a)(u,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mtdt-catalogue"},[a("div",[t._v(t._s(t.metaDisplayed))]),t._v(" "),a("formater-draw-bbox"),t._v(" "),a("div",[a("div",{staticClass:"mtdt-column-left"},[a("formater-form",{attrs:{disableLevel:1,depth:1}})],1),t._v(" "),a("div",{staticClass:"mtdt-column-right"},[a("div",{attrs:{id:"fmtLargeMap"}}),t._v(" "),t.$store.state.searching?a("div",{staticClass:"fmt-waiting"},[a("div",[t._v(t._s(t.$t("searching"))),a("br"),a("span",{staticClass:"fa fa-spinner animated"})])]):t._e(),t._v(" "),t.$store.state.error?a("div",{staticClass:"fmt-error"},[a("div",[a("span",{staticClass:"fa fa-close fmt-close",on:{click:t.closeError}}),t._v(t._s(t.$store.state.error))])]):t._e(),t._v(" "),t.$store.state.selectedMetadata?a("div",{staticClass:"mtdt-free-capsule"},[a("div",[a("formater-metadata",{attrs:{metadata:t.$store.state.selectedMetadata,depth:-1},on:{close:t.closeSingle}})],1)]):t._e(),t._v(" "),t.metadata?a("formater-metadata",{attrs:{metadata:t.metadata,depth:1},on:{parametersChange:t.setParameters,close:t.close}}):t._e()],1)])],1)}),[],!1,null,null,null);"function"==typeof c.default&&Object(c.default)(l),e.default=l.exports}}]);
//# sourceMappingURL=9.formater-metadata-vjs.js.map
{"version":3,"file":"253.formater-metadata-vjs.js","mappings":"6GAAAA,EAAOC,QAAU,SAAUC,GACzBA,EAAUC,QAAQC,OAASF,EAAUC,QAAQC,QAAU,GACvDF,EAAUC,QAAQC,OAAOC,KAAK,uLACvBH,EAAUC,QAAQG,KAC3B,C,WCJAN,EAAOC,QAAU,SAAUC,GACzBA,EAAUC,QAAQC,OAASF,EAAUC,QAAQC,QAAU,GACvDF,EAAUC,QAAQC,OAAOC,KAAK,mFACvBH,EAAUC,QAAQG,KAC3B,C,4DCiBA,MCrBmL,EDqBnL,CACA,yBACA,OACA,OACA,YACA,YAGA,OACA,OADA,SACA,KACA,kBAEA,GAEA,KAdA,WAeA,OACA,SACA,SACA,SACA,2CACA,qEAEA,SACA,cACA,cACA,wBACA,6BACA,4BACA,8BACA,yBACA,2BACA,2BAEA,mBACA,SACA,kBACA,eAEA,EACA,QAvCA,WAwCA,+BACA,yFAGA,4BAsBA,EACA,UAnEA,WAsFA,EACA,QAvFA,WA6FA,EACA,SACA,eADA,WAEA,iBACA,qBACA,aAEA,cACA,OACA,mCAGA,iCACA,qBACA,wCAGA,EACA,WAjBA,SAiBA,GAOA,yCAgBA,uBAGA,uBACA,kBACA,EAWA,eAxDA,SAwDA,GACA,mBACA,OACA,OACA,OACA,OACA,0BAKA,OAJA,eACA,gBACA,iBACA,aAEA,EACA,eArEA,SAqEA,GAEA,sBAsBA,qBACA,+DACA,2CAEA,2BACA,+DAcA,EAaA,qBA7HA,WA6HA,WACA,iDACA,YACA,aACA,wBACA,+BAEA,aACA,qEACA,yBACA,GAEA,EAkCA,WA3KA,SA2KA,cACA,aAMA,OACA,2CACA,6DAEA,uDACA,kDACA,8CAEA,sBACA,yEACA,qBASA,WAEA,8BAGA,iEACA,eACA,IAEA,qBAGA,iEACA,eACA,IAGA,0DACA,eACA,IAEA,iCACA,4CAEA,0BAGA,sFACA,kEAIA,kEACA,4BACA,cACA,oCACA,+CACA,oCA5DA,CA6DA,EAmBA,eA9PA,SA8PA,KACA,iBACA,OACA,mEACA,MACA,SACA,2EACA,MACA,SACA,4EACA,MACA,QACA,sDAEA,wCACA,EAuBA,oBApSA,SAoSA,KACA,SACA,6CACA,SACA,OACA,cAEA,oCACA,qCACA,2CACA,6CACA,GACA,SAEA,MACA,kCACA,4BACA,kCACA,oCACA,GACA,SAEA,SAhBA,OAkBA,aACA,oBACA,aACA,eACA,yCACA,iDAEA,EAEA,mBArUA,SAqUA,GACA,uCACA,EAEA,mBACA,OAFA,KAIA,+BACA,+BACA,IACA,MACA,aAEA,CACA,EACA,wBApVA,SAoVA,cACA,gBAEA,gBACA,8DAIA,4EAGA,OACA,2CACA,6DAEA,GACA,qBACA,OACA,KACA,yCACA,gDAEA,gDACA,iBACA,cACA,oCACA,yCAEA,aACA,CAEA,EACA,gBApXA,SAoXA,GACA,+EACA,EAoBA,gBA1YA,SA0YA,GAgEA,IA/DA,uBACA,UACA,qBACA,mDAEA,aACA,gDAEA,kBACA,mDAEA,WACA,2CAEA,aACA,gDAEA,YACA,4CAEA,SACA,kBAEA,cACA,sCACA,aAEA,kBAEA,UAEA,kBACA,aACA,aAEA,8CACA,YACA,gDACA,WACA,GACA,cACA,YACA,mBACA,WACA,YACA,YAEA,gBACA,KAEA,+CACA,aACA,eAEA,6CAGA,YAEA,gBACA,kBAGA,SAEA,IADA,qBACA,KACA,2DACA,mCACA,qBAEA,yDACA,kCACA,4BAGA,OACA,CAEA,iBACA,qCACA,oBACA,sCACA,oBACA,wBACA,wBACA,mDACA,kBACA,CAqBA,OAPA,aACA,aACA,gCACA,sBACA,WACA,YAEA,CACA,EAoBA,KA5gBA,SA4gBA,KACA,mBACA,0DACA,yBACA,I,wBEnoB6M,Q,MAAA,GCO7M,IAAIC,GAAY,OACd,GCRW,WAA+C,OAAOC,EAA5BC,KAAYC,MAAMF,IAAa,MACrE,GACqB,IDSpB,EACA,KACA,KACA,MAMoB,mBAAX,GAAuB,EAAOD,GAEzC,QAAeA,EAAiB,O,4DEtBhC,I,kDC0EA,MC1E6K,ED0E7K,CACA,yBACA,YACA,qBACA,iBACA,+BACA,iBAnBA,iDAoBA,yBACA,6BAGA,KAXA,WAYA,OACA,iBACA,SACA,UACA,mBAIA,aACA,sBACA,WACA,yBACA,wBACA,kBAEA,4CAEA,EACA,OACA,O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","sources":["webpack://formater-metadata-vjs/./src/components/formater-requester.vue?5ac4","webpack://formater-metadata-vjs/./src/formater-catalogue.vue?c524","webpack://formater-metadata-vjs/src/components/formater-requester.vue","webpack://formater-metadata-vjs/./src/components/formater-requester.vue?b09d","webpack://formater-metadata-vjs/./src/components/formater-requester.vue?a3a6","webpack://formater-metadata-vjs/./src/components/formater-requester.vue?e8d5","webpack://formater-metadata-vjs/./src/components/formater-requester.vue","webpack://formater-metadata-vjs/./src/formater-catalogue.vue","webpack://formater-metadata-vjs/src/formater-catalogue.vue","webpack://formater-metadata-vjs/./src/formater-catalogue.vue?d271","webpack://formater-metadata-vjs/./src/formater-catalogue.vue?43cf","webpack://formater-metadata-vjs/./src/formater-catalogue.vue?2b96"],"sourcesContent":["module.exports = function (Component) {\n  Component.options.__i18n = Component.options.__i18n || []\n  Component.options.__i18n.push('{\"fr\":{\"SERVICE_UNAVAILABLE\":\"Le service est indisponible. Veuillez revenir plus tard!\"},\"en\":{\"SERVICE_UNAVAILABLE\":\"The service is unavailable. Please come back later!\"}}')\n  delete Component.options._Ctor\n}\n","module.exports = function (Component) {\n  Component.options.__i18n = Component.options.__i18n || []\n  Component.options.__i18n.push('{\"en\":{\"searching\":\"Searching\"},\"fr\":{\"searching\":\"Recherche en cours\"}}')\n  delete Component.options._Ctor\n}\n","/**\n * use geonetwork q-search service \n * @see https://geonetwork-opensource.org/manuals/trunk/eng/users/api/q-search.html\n * \n * use opensearch api with extension geo, time, and eo\n * @see http://www.opensearch.org/Home\n * \n */\n<i18n>{\n  \"fr\": {\n    \"SERVICE_UNAVAILABLE\": \"Le service est indisponible. Veuillez revenir plus tard!\"\n  },\n  \"en\": {\n     \"SERVICE_UNAVAILABLE\": \"The service is unavailable. Please come back later!\"\n  }\n}\n</i18n>\n<template></template>\n<script>\n\n\nexport default {\n  name: 'FormaterRequester',\n  props: {\n    depth: {\n      type: Number,\n      default:0\n    }\n  },\n  watch: {\n    $route (newroute, old) {\n      this.getRecords(newroute)\n      \n    }\n  },\n  data() {\n    return {\n      srv: null,\n      api: null,\n      headers: {\n        'Accept': 'application/json, text/plain, */*',\n        'Accept-Language': this.$store.state.lang === 'fr' ? 'fre,eng': 'eng,fre'\n      },\n      first: true,\n      dimensions: [],\n      parameters: {},\n      changePageListener:null,\n      temporalChangedListener: null,\n      spatialChangedListener: null,\n      dimensionChangedListener: null,\n      textChangedListener: null,\n      selectChangedListener: null,\n      closeMetadataListener: null,\n      // listen a global reset event\n      resetListener: null,\n      facet: [],\n      type: 'geonetwork',\n      credentials: {}\n     }\n  },\n  created () {\n    if (this.$store.state.geonetwork) {\n       this.srv = this.$store.state.geonetwork +  'srv/' + (this.$i18n.locale === 'fr'? 'fre' : 'eng') + '/'\n       // this.srv = this.$store.state.geonetwork +  'srv/fre/'\n    }\n    this.getRecords(this.$route)\n    \n\n    // this.getRecords() done when <formater-paging> is mounted with its pageChangeEvent on order control change\n//     this.pageChangedListener = this.changePage.bind(this)\n//     document.addEventListener('fmt:pageChangedEvent', this.pageChangedListener);\n//     this.temporalChangedListener = this.getRecords.bind(this)\n//     document.addEventListener('temporalChangeEvent', this.temporalChangedListener);\n//     this.spatialChangedListener = this.getRecords.bind(this)\n//     document.addEventListener('fmt:spatialChangeEvent', this.spatialChangedListener);\n//     this.dimensionChangedListener = this.getRecords.bind(this);\n//     document.addEventListener('fmt:dimensionChangeEvent', this.dimensionChangedListener);\n//     this.textChangedListener = this.getRecords.bind(this);\n//     document.addEventListener('fmt:textChangeEvent', this.textChangedListener);\n//     this.selectChangedListener = this.getRecords.bind(this);\n//     document.addEventListener('fmt:selectChangeEvent', this.selectChangedListener)\n//      this.metadataWithChildListener = this.getRecords.bind(this)\n//     document.addEventListener('fmt:metadataWithChildEvent', this.metadataWithChildListener)\n//     this.closeMetadataListener = this.getRecords.bind(this)\n//      document.addEventListener('fmt:closeMetadataEvent', this.closeMetadataListener)\n//     this.resetListener = this.handleReset.bind(this);\n//      document.addEventListener('fmt:resetEvent', this.resetListener);\n  },\n  destroyed () {\n//     document.removeEventListener('fmt:pageChangedEvent', this.pageChangedListener);\n//     this.pageChangedListener = null;\n//     document.removeEventListener('temporalChangeEvent', this.temporalChangedListener);\n//     this.temporalChangedListener = null;\n//     document.removeEventListener('fmt:spatialChangeEvent', this.spatialChangedListener);\n//     this.spatialChangedListener = null;\n//     document.addEventListener('fmt:dimensionChangeEvent', this.dimensionChangedListener);\n//     this.dimensionChangedListener = null\n//     document.removeEventListener('fmt:textChangeEvent', this.textChangedListener)\n//     this.textChangedListener = null\n//     document.removeEventListener('fmt:selectChangeEvent', this.selectChangedListener)\n//     this.selectChangedListener = null\n//     document.removeEventListener('fmt:metadataWithChildEvent', this.metadataWithChildListener)\n//     this.metadataWithChildListener = null\n//      document.addEventListener('fmt:closeMetadataEvent', this.closeMetadataListener)\n//      this.closeMetadataListener = null\n//     document.addEventListener('fmt:resetEvent', this.resetListener);\n//     this.resetListener = null\n  },\n  mounted () {\n//     this.facet.facetFormaterFre = []\n//     this.facet.facetFormaterFre.push('https%3A%2F%2Fw3id.org%2Fformater%2Fvariable%2Fsolid_earth/https%3A%2F%2Fw3id.org%2Fformater%2Fvariable%2Fgeothermal/https%3A%2F%2Fw3id.org%2Fformater%2Fvariable%2Fgeothermal-geothermal_temperature')\n//     this.facet.facetFormaterFre.push( 'https%3A%2F%2Fw3id.org%2Fformater%2Fvariable%2Fsolid_earth/https%3A%2F%2Fw3id.org%2Fformater%2Fvariable%2Fnon_solid/https%3A%2F%2Fw3id.org%2Fformater%2Fvariable%2Fnon_solid-hydrogen_gas')\n   \n    // url=\"http://demo.formater/geonetwork/srv/fre/qi?_content_type=json&bucket=2365825987452666&fast=index&from=1&to=41\"\n  },\n  methods: {\n    initParameters () {\n        this.parameters = {\n          _content_type: 'json',\n           fast: 'index', // more quick\n        //  'facet.q': '',\n          bucket: 's101',\n          from: 1,\n          to: this.$store.state.size.nbRecord,\n          //  resultType: 'subtemplate',\n          // resultType: 'details',\n          sortBy: this.$store.state.orderBy,\n          sortOrder: 'ordering',\n          type:'dataset+or+series+or+publication'\n         }\n       \n    }, \n    getRecords (event) {\n      \n//       if (this.$store.state.metadata && this.first) {\n//         this.first = false\n//         this.searchSimpleMetadata()\n//         return\n//       }\n      this.$store.commit('searchingChange', true)\n      // trigger search event like breadcrumb\n//       if (event.detail && typeof event.detail.depth == 'number') {\n//         var depth = event.detail.depth\n//       } else {\n//         var depth = this.depth\n//       }\n//       var e = new CustomEvent(\"aerisSearchEvent\", { detail: {depth: depth}});\n//       document.dispatchEvent(e);\n     \n//       if (e.detail.api) {\n//         this.api = e.detail.api\n//         delete e.detail.api\n//         this.type = 'opensearch'\n        \n //     } else {\n        this.type = 'geonetwork'\n//      }\n\n      this.prepareRequest(event)\n      this.requestApi(event)\n    },\n//     prepareRequest (e) {\n//       switch (this.type) {\n//       case 'geonetwork':\n//         this.prepareRequestGeonetwork(e)\n//         break;\n//       case 'opensearch':\n//         this.prepareRequestOpensearch(e)\n//         break\n//       }\n//     },\n    createGeometry (bbox) {\n      var split = bbox.split(',')\n      var north = split[3]\n      var south = split[1]\n      var east = split[2]\n      var west = split[0]\n      var box = 'POLYGON((' + west + '+' + north + ','\n        box += east + '+' + north + ',';\n        box += east + '+' + south + ',';\n        box += west + '+' + south + ',';\n        box += west + '+' + north + '))';\n      return box;\n    },\n    prepareRequest(route) {\n      \n      this.initParameters()\n      \n      // delete e.detail.lang\n//       if (!e.detail.startDefault) {\n//         e.detail.renameProperty('start', 'extFrom')\n//       } else {\n//         delete e.detail.start\n//       }\n//       if (e.detail.endDefault) {\n//         delete e.detail.endDefault\n//         delete e.detail.end\n        \n//       } else {\n//         e.detail.renameProperty('end', 'extTo')\n//       }\n//       delete e.detail.startDefault\n//       delete e.detail.endDefault\n//       delete e.detail.box\n\n//      // delete e.detail.depth\n//       delete e.detail.recordPerPage\n     \n      if (route.name === 'Metadata') {\n       this.parameters.resultType = this.$store.state.summaryType.step2\n       this.parameters.parentUuid = route.params.uuid\n      } else {\n       this.parameters.isChild = false\n       this.parameters.resultType = this.$store.state.summaryType.step1\n      }\n//       if (e.detail.depth > 0) {\n//         // voir plutôt les key à éliminer centre de données, variable, instruments, gemet, types?\n//         for(var key in e.detail) {\n//           if (['any', 'geometry', 'extTo', 'extFrom', 'from', 'to', 'parentUuid', 'type'].indexOf(key) >=0){\n//             this.parameters[key] = e.detail[key]\n//           }\n//         }\n//       } else {\n        // this.prepareFacet(route)\n     \n        var _this = this\n\n    },\n//     prepareRequestOpensearch(e) {\n//       this.initParameters()\n//        if (e.detail.startDefault) {\n//         delete e.detail.start\n//       }\n//       if (e.detail.endDefault) {\n//         delete e.detail.end\n//       } \n//       this.mapParameters(e)\n//       this.parameters = Object.assign(this.parameters, e.detail)   \n\n//     },\n    searchSimpleMetadata() {\n      this.$http.get(this.$store.state.metadata).then(\n          response => {  \n            var data = response.body\n            var uuid = data['geonet:info'].uuid\n            var meta = this.$gn.treatmentMetadata(data, uuid);\n            // var feature = self.$gn.extractBbox(data.geoBox, uuid)\n            meta.appRoot = true\n            var event = new CustomEvent('fmt:metadataEvent', {detail: {meta:meta, depth: 0 } })\n            document.dispatchEvent(event)\n         }\n        )\n    },\n//     mapParameters(e) {\n//       // transform the name of parameter from this application to the opensearch api for the predefined parameter\n//       // or test if it is an opensearch parameter\n//       // paramaters specific to api opensearch\n//       var specificParameters = this.$store.state.parameters.others\n//       // parameters mapping with our app parameters\n//       var mappingParameters = this.$store.state.parameters.mapping\n//       for(var name in e.detail){\n        \n//         if (typeof mappingParameters[name] !== 'undefined') {\n//           e.detail.renameProperty(name, mappingParameters[name])\n//         } else  {\n//           var isSpecific = specificParameters.find(function (obj) {\n//             if (obj.name === name) {\n//               return true\n//             }\n//           })\n//           if (!isSpecific) {\n//             delete e.detail[name]\n//           }\n//         } \n//       }\n//     },\n//     requestApi (depth)  {\n//         switch (this.type) {\n//         case 'geonetwork':\n//           this.requestApiGeonetwork(depth)\n//           break;\n//         case 'opensearch':\n//           this.requestApiOpensearch(depth)\n//           break;\n//         }\n//     },\n    requestApi (route) {\n      if (!this.srv) {\n        return\n      }\n      // var depth = (typeof this.parameters.depth != 'undefined') ? this.parameters.depth : this.depth\n     \n     // delete this.parameters.depth\n      var headers =  {\n          'Accept': 'application/json, text/plain, */*',\n          'Accept-Language': this.$store.state.lang === 'fr' ? 'fre': 'eng'\n       }\n      this.parameters = Object.assign(this.parameters, route.query)\n      this.parameters.renameProperty('start', 'extFrom')\n      this.parameters.renameProperty('end', 'extTo')\n\n      if (this.parameters.box) {\n          this.parameters.geometry = this.createGeometry(this.parameters.box)\n          delete this.parameters.box\n      }\n      //first requête to type=me to record session and token\n//       this.$http.get('http://demo.formater/geonetwork/srv/fre/info?type=me', {credentials:true, headers: headers}).then(\n//           response => {console.log(response.headers)}\n//       )\n//       this.$http.get('http://demo.formater/geonetwork/srv/fre/info?type=me', {credentials:true, headers: headers}).then(\n//           response => {console.log(response.headers)}\n//       )\n      var self = this\n      // parameters according to depth\n      if (route.name === 'FormaterCatalogue') {\n     // if (depth === 0) {\n        // remove all parameters coming from step2 (normally there is not)\n        this.$store.state.gnParameters.step2.forEach(function (key) {\n          delete self.parameters[key]\n        })\n      }\n      if (route.name === 'Metadata') {\n     // if (depth > 0) {\n        // remove all parameters exlusivy reserve to step1\n        this.$store.state.gnParameters.step1.forEach(function (key) {\n          delete self.parameters[key]\n        })\n      }\n      \n      ['index', 'maxRecords', 'page'].forEach(function (key) {\n        delete self.parameters[key]\n      })\n    \n      if (this.parameters.sortBy === 'title') {\n        this.parameters.sortOrder = 'ordering'\n      } else {\n        delete this.parameters.sortOrder\n        // this.parameters.sortOrder = 'reverse'\n      }\n      if (route.name === 'FormaterCatalogue' && this.$store.state.group && !this.parameters._groupOwner) {\n        this.parameters._groupOwner = this.$store.state.group.join('+or+')\n      }\n      // this.$router.push({name: 'FormaterCatalogue', query:this.parameters})\n      // this.parameters.sortOrder =  this.parameters.sortBy === 'title' ? 'ordering': 'reverse';\n      var url = this.srv + 'q?' + Object.keys(this.parameters).map(function (prop) {\n        return prop + '=' + self.parameters[prop]\n      }).join('&');\n      this.$http.get(url, {headers: headers}).then(\n        response => { this.treatmentGeonetwork(response.body, 0);},\n        response => { this.treatmentError(response, url); })\n    },\n//     requestApiOpensearch (depth) {\n// \t\t  if (!this.api) {\n// \t\t    this.$store.commit('searchingChange', false)\n// \t\t    return\n// \t\t  }\n//       // var depth = (typeof this.parameters.depth != 'undefined') ? this.parameters.depth : this.depth\n//       var self = this\n//       var url = this.api + (this.api.indexOf('?') > 0 ? '&' :'?');\n//       // register parameters value\n//       url += Object.keys(this.parameters).map(function (prop) {\n//         return prop + '=' + self.parameters[prop]\n//       }).join('&');\n//       this.$emit('registerValues', {depth: depth, parameters: this.parameters})\n//      // this.$store.commit('addValueToParameters', this.parameters)\n//       this.$http.get(url).then(\n//           response => {   this.treatmentGeojson(response.body, depth);},\n//           response => { this.treatmentError(response, url); })\n//     },\n    treatmentError (response, url) {\n      switch(response.status) {\n      case 0:\n        this.$store.commit('setError', this.$i18n.t('SERVICE_UNAVAILABLE'))\n        break;\n      case 403:\n        this.$store.commit('setError', 'SERVER RESPONSE FOR ' + url + ' : ACCESS DENIED')\n        break;\n      case 404:\n        this.$store.commit('setError', 'SERVER RESPONSE FOR ' + url + ' : PAGE NOT FOUND')\n        break;\n      default:\n        this.$store.commit('setError', 'UNKNOWN ERROR FOR ' + url)\n      }\n      this.$store.commit('searchingChange', false)\n    },\n//     treatmentGeojson (data, depth) {\n//       var metadatas = {}\n//       var self = this\n//       var features = []\n//       data.features.forEach( function (feature) {\n//         feature.properties.id = feature.id\n//         metadatas[feature.id] =  self.mapToGeonetwork(feature.properties)\n//         features.push({type: feature.type, id: feature.id, geometry: feature.geometry})\n       \n//       })\n//       if (data.features.length === 0) {\n//         metadatas = {}\n//       }\n//       if (data.properties) {\n//         var properties = data.properties\n//       } else {\n//         var properties = data.description\n//       }\n\n//       this.fill({ type: 'opensearch', properties: data.properties, features: features, metadata:metadatas}, depth)\n//       this.$store.commit('searchingChange', false)\n//     },\n    treatmentGeonetwork (data, depth) {\n      var metadatas = {}\n      this.treatmentDimension(data.summary.dimension)\n      var features = []\n      var self = this\n      if (!data.metadata){\n        var metadatas = null\n      } else if (data.metadata && !data.metadata.forEach) {\n        var uuid = data.metadata['geonet:info'].uuid\n        metadatas[uuid] = self.$gn.treatmentMetadata(data.metadata ,uuid)\n        var feature = self.$gn.extractBbox(data.metadata.geoBox, uuid)\n        if (feature) {\n            features.push(feature)\n        }\n      } else {\n           data.metadata.forEach( function (meta, index) {\n             var uuid = meta['geonet:info'].uuid\n             metadatas[uuid] = self.$gn.treatmentMetadata(meta ,uuid)\n              var feature = self.$gn.extractBbox(meta.geoBox, uuid)\n              if (feature) {\n                    features.push(feature)\n              }\n           })\n      }\n      data.metadata = metadatas\n      data.type = 'geonetwork'\n      data.features = features\n      this.fill(data, depth)\n      this.$store.commit('searchingChange', false)\n      this.searchGnStep2Parameters(data.summary.dimension)\n      // this.searchRelated()\n    },\n    // remove groupOwner if only one group choose in app parameters\n    treatmentDimension (dimensions) {\n      if (this.$store.state.group.length === 1) {\n        if (!dimensions) {\n          dimensions = []\n        } else if (!Array.isArray(dimensions)) {\n          dimensions = [dimensions]\n        }\n        var find = dimensions.findIndex(function (dimension) {\n          return dimension['@name'] === 'groupOwner'\n        })\n        if (find >= 0) {\n          dimensions.splice(find, 1)\n        }\n      }\n    },\n    searchGnStep2Parameters (dimension) {\n      if (this.first) {\n        // register dimension in store\n        if (this.depth === 0) {\n          this.$store.commit('gnParametersChange', {step:1, dimension: dimension})\n        }\n        // this.$store.commit('gnParametersChange', {step:2, dimension:[]})\n        // search summary for all record (including child dataset) for step 2\n        if (this.$store.state.summaryType.step1 !== this.$store.state.summaryType.step2) {\n          \n          // var depth = (typeof this.parameters.depth != 'undefined') ? this.parameters.depth : this.depth\n          var headers =  {\n              'Accept': 'application/json, text/plain, */*',\n              'Accept-Language': this.$store.state.lang === 'fr' ? 'fre': 'eng'\n           }\n          var parameters = {\n              _content_type: 'json',\n              from:1,\n              to: 9,\n              type: 'dataset+or+series+or+publications',\n              resultType: this.$store.state.summaryType.step2\n          }\n          var url = this.srv + 'q?' + Object.keys(parameters).map(function (prop) {\n            return prop + '=' + parameters[prop]\n          }).join('&');\n          this.$http.get(url, {headers: headers}).then(\n            response => {  this.addGnParameters(response.body);}\n          )\n          this.first = false\n        }\n      }\n    },\n    addGnParameters(data) {\n      this.$store.commit('gnParametersChange', {step:2, dimension:data.summary.dimension})\n    },\n//     updateGeonetworkContacts (data) {\n//       data.responsibleParty.forEach( function (contact)  {\n//           var fields = contact.split('|');\n//           if (fields[1] === 'metadata' || fields[1] === 'metadonnées') {\n//            if (_this.contacts.metadata[fields[0]]){\n//              _this.contacts.metadata[fields[0]].push(fields)\n//            } else {\n//              _this.contacts.metadata[fields[0]] = [fields]\n//            }\n//           }else{\n//             if (_this.contacts.resource[fields[0]]){\n//                _this.contacts.resource[fields[0]].push(fields)\n//             } else {\n//                _this.contacts.resource[fields[0]] = [fields]\n//             }\n//           }\n                \n//       })\n//     },\n    mapToGeonetwork (properties) {\n      var properties = Object.assign({}, properties)\n      properties.fromOs = true\n      if (properties.productIdentifier) {\n        properties.renameProperty('productIdentifier', 'identifier')\n      }\n      if (properties.startDate) {\n        properties.renameProperty('startDate', 'tempExtentBegin')\n      }\n      if (properties.completionDate) {\n        properties.renameProperty('completionDate', 'tempExtentEnd')\n      }\n      if (properties.updated) {\n        properties.renameProperty('updated', 'revisionDate')\n      }\n      if (properties.published) {\n        properties.renameProperty('published', 'publicationDate')\n      }\n      if (properties.produced) {\n        properties.renameProperty('produced', 'creationDate')\n      }\n      if (!properties.type) {\n        properties.type = 'dataset'\n      }\n      if (properties.quicklook) {\n        properties.images = [['', properties.quicklook, '']]\n        delete properties.quicklook\n      }\n      if (properties.license) {\n       // properties.legalConstraints = [properties.license.licenseId]\n        delete properties.license\n      }\n      properties.osParameters = []\n      properties.mapping = []\n      if (properties.services) {\n        // @todo cas très très particulier de flatsim\n        if(properties.services.browse && properties.services.browse.layers) {\n          properties.layers = []\n          properties.services.browse.layers.forEach(function (flatsimLayer, index) {\n            var type =  flatsimLayer.type\n            var layer = {\n                id: properties.id + '_' + index,\n                name: flatsimLayer.name,\n                description:  flatsimLayer.name,\n                href: flatsimLayer.url,\n                type: flatsimLayer.type,\n                checked: false\n            }\n            properties.layers.push(layer)\n          })\n        }\n        if(properties.services.download && properties.services.download.url) {\n          if (!properties.download) {\n            properties.download = []\n          }\n          properties.download.push(properties.services.download)\n          \n        }\n        delete properties.services\n      }\n      if( !properties.exportLinks) {\n        properties.exportLinks = {}\n      }\n      // @todo Flatsim cas particulier des LIENS D'EXPORT qui se trouve dans link\n      if (properties.links) {\n        var i = properties.links.length\n        while (i--) {\n          if (properties.links[i].type === 'application/json' && !properties.exportLinks.json) {\n            properties.exportLinks.json = properties.links[i].href\n            properties.links.splice(i,1)\n          }\n          if (properties.links[i].type === 'application/xml' && !properties.exportLinks.xml) {\n            properties.exportLinks.xml = properties.links[i].href\n            properties.links.splice(i,1)\n          }\n        }\n        delete properties.links\n      }\n\n      if (!properties.contacts) {\n        properties.contacts = {metadata: {}, resource: {}}\n        if (properties.organisationName) {\n          if (typeof properties.organisationName === 'string') {\n            var responsible = new Array(10)\n            responsible[0] = 'Point of contact'\n            responsible[2] = properties.organisationName\n            properties.contacts.metadata['Point of contact'] = [responsible]\n            delete properties.organisationName\n          }\n        }\n      }\n     /* if (properties.keywords) {\n        properties.keywordGroup = {}\n        properties.keywords.forEach(function (keyword) {\n          if (!properties.keywordGroup[keyword.type]) {\n            properties.keywordGroup[keyword.type] = [{value: keyword.name}]\n          } else {\n            properties.keywordGroup[keyword.type].push({value: keyword.name})\n          }\n        })\n        delete properties.keywords\n      }*/\n      if (properties.keywords) {\n        properties.keyword = []\n        properties.keywords.forEach(function (keyword) {\n          properties.keyword.push(keyword.name)\n        })\n        delete properties.keywords\n      }\n      return properties\n    },\n    // @todo DEPLACER DANS FORM VOIR MÊME DANS formater-dimension-block/ formater-facet-block!!\n//     prepareFacet (e) {\n//       var facet = ''\n     \n//       for(var key in e.detail.facet) {\n//         if (e.detail.facet[key].length > 0) {\n//           if (facet === '') {\n//             facet = key +'/' + e.detail.facet[key]\n//           } else {\n//             facet += '&' + key + '/' + e.detail.facet[key]\n//           }\n//         }\n//       }\n//       if (facet !== '') {\n//        e.detail['facet.q'] = encodeURIComponent(facet)\n//        delete e.detail.facet\n//       }\n//       return e;\n//     },\n    fill (data, depth) {\n      data.depth = this.depth\n      var event = new CustomEvent('fmt:metadataListEvent', {detail:  data})\n      document.dispatchEvent(event)\n    },\n//     handleReset () {\n//       var event = new CustomEvent('aerisResetEvent', {detail: {}})\n//       document.dispatchEvent(event)\n//       this.getRecords({detail: {depth:event.detail.depth}})\n//     },\n//     changePage (event) {\n//       this.getRecords(event)\n//     },\n//     changeSearch (event) {\n//       this.parameters.any = event.target.value\n//       this.getRecords()\n//     }\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./formater-requester.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./formater-requester.vue?vue&type=script&lang=js&\"","import mod from \"-!../../node_modules/@intlify/vue-i18n-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./formater-requester.vue?vue&type=custom&index=0&blockType=i18n\"; export default mod; export * from \"-!../../node_modules/@intlify/vue-i18n-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./formater-requester.vue?vue&type=custom&index=0&blockType=i18n\"","import { render, staticRenderFns } from \"./formater-requester.vue?vue&type=template&id=4a0cb389&\"\nimport script from \"./formater-requester.vue?vue&type=script&lang=js&\"\nexport * from \"./formater-requester.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* custom blocks */\nimport block0 from \"./formater-requester.vue?vue&type=custom&index=0&blockType=i18n\"\nif (typeof block0 === 'function') block0(component)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c(\"div\")\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"mtdt-catalogue\"},[_c('div',[_vm._v(_vm._s(_vm.metaDisplayed))]),_vm._v(\" \"),_c('formater-requester',{attrs:{\"depth\":0}}),_vm._v(\" \"),_c('formater-draw-bbox'),_vm._v(\" \"),_c('div',[_c('div',{staticClass:\"mtdt-column-left\"},[_c('formater-form',{attrs:{\"disableLevel\":0,\"depth\":0}})],1),_vm._v(\" \"),_c('div',{staticClass:\"mtdt-column-right\"},[_c('div',{attrs:{\"id\":\"fmtLargeMap\"}}),_vm._v(\" \"),(_vm.$store.state.searching)?_c('div',{staticClass:\"fmt-waiting\"},[_c('div',[_vm._v(_vm._s(_vm.$t('searching'))),_c('br'),_c('span',{staticClass:\"fa fa-spinner animated\"})])]):_vm._e(),_vm._v(\" \"),(_vm.$store.state.error)?_c('div',{staticClass:\"fmt-error\"},[_c('div',[_c('span',{staticClass:\"fa fa-close fmt-close\",on:{\"click\":_vm.closeError}}),_vm._v(_vm._s(_vm.$store.state.error))])]):_vm._e(),_vm._v(\" \"),(_vm.$store.state.selectedMetadata)?_c('div',{staticClass:\"mtdt-free-capsule\"},[_c('div',[_c('formater-metadata',{attrs:{\"metadata\":_vm.$store.state.selectedMetadata,\"depth\":-1},on:{\"close\":function($event){return _vm.closeSingle()}}})],1)]):_vm._e(),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.metadatas.length === 0),expression:\"metadatas.length === 0\"}]},[_c('formater-paging',{attrs:{\"depth\":0,\"orders\":['changeDate', 'popularity', 'title'],\"order-by\":_vm.sortBy}}),_vm._v(\" \"),_c('formater-list-metadata',{attrs:{\"depth\":0}})],1),_vm._v(\" \"),_c('div',_vm._l((_vm.metadatas),function(meta,index){return _c('formater-metadata',{directives:[{name:\"show\",rawName:\"v-show\",value:(index === _vm.metadatas.length-1),expression:\"index === metadatas.length-1\"}],key:index,attrs:{\"depth\":index + 1,\"metadata\":meta},on:{\"parametersChange\":_vm.setParameters,\"close\":_vm.close}})}),1)])])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\n * Main component\n */\n<i18n>{\n   \"en\":{\n     \"searching\": \"Searching\"\n   },\n   \"fr\":{\n     \"searching\": \"Recherche en cours\"\n   }\n}\n</i18n>\n<template>\n <div class=\"mtdt-catalogue\">\n <div>{{metaDisplayed}}</div>\n  <!-- components not visible  -->\n <formater-requester  :depth=\"0\" ></formater-requester>\n  <!-- component to draw bbox -->\n  <formater-draw-bbox ></formater-draw-bbox>\n\n  <div >\n   <!-- components can be view -->\n \n   <div class=\"mtdt-column-left\" >\n       <formater-form  :disableLevel=\"0\" :depth=\"0\"></formater-form>\n   </div>\n   <div class=\"mtdt-column-right\" >\n        <!-- div where append map when enlarge it -->\n        <div id=\"fmtLargeMap\"></div>\n        <!-- icon search -->\n        <div class=\"fmt-waiting\" v-if=\"$store.state.searching\"><div>{{$t('searching')}}<br /><span class=\"fa fa-spinner animated\"></span></div></div>\n        \n        <!--error msg -->\n        <div class=\"fmt-error\" v-if=\"$store.state.error\"><div><span class=\"fa fa-close fmt-close\" @click=\"closeError\"></span>{{$store.state.error}}</div></div>\n        \n        <!-- independant metadata -->\n        <div class=\"mtdt-free-capsule\" v-if=\"$store.state.selectedMetadata\" >\n          <div >\n            <formater-metadata :metadata=\"$store.state.selectedMetadata\" :depth=\"-1\" @close=\"closeSingle()\"></formater-metadata>\n          </div>\n        </div>\n        <!-- list of all records with page navigation -->\n        <div  v-show=\"metadatas.length === 0\">\n            <formater-paging   :depth=\"0\" :orders=\"['changeDate', 'popularity', 'title']\" :order-by=\"sortBy\"></formater-paging>\n            <formater-list-metadata :depth=\"0\"></formater-list-metadata>\n        </div>\n        \n        <!-- view of one record -->\n        <div>\n        <formater-metadata v-for=\"(meta, index) in metadatas\" :key=\"index\" v-show=\"index === metadatas.length-1\"\n         :depth=\"index + 1\" :metadata=\"meta\" @parametersChange=\"setParameters\"\n         @close=\"close\" ></formater-metadata>\n        </div>\n\n     </div>\n    </div>\n  </div>\n</template>\n<script>\nimport FormaterForm from './components/formater-form.vue';\nimport FormaterListMetadata from './components/formater-list-metadata.vue';\nconst FormaterMetadata = () => import('./components/formater-metadata.vue')\nimport FormaterPaging from './components/formater-paging.vue';\nimport FormaterDrawBbox from './components/formater-draw-bbox.vue';\n// import AerisTheme from 'aeris-commons-components-vjs/src/aeris-theme/aeris-theme.vue'\nimport FormaterRequester from './components/formater-requester.vue'\n\n// prevent previous and next page for browser\n// function disableBack() { window.history.forward() }\n// window.onload = function () {\n//   disableBack();\n// }\n//   window.onpageshow = function(evt) { if (evt.persisted) disableBack() }\n//   window.onbeforeunload = function() { return \"Your work will be lost.\"; };\nexport default {\n  name: 'FormaterCatalogue',\n  components: {\n    FormaterDrawBbox,\n    FormaterForm,\n    FormaterListMetadata,\n    FormaterMetadata,\n    FormaterPaging,\n    FormaterRequester\n  },\n \n  data() {\n    return {\n      currentUuid: null,\n      first: true,\n      sortBy: '',\n      metaDisplayed: null,\n      // bbox: null,\n      // depth: null,\n      // array breadcrumb of records\n      metadatas: [],\n      metadataListener: null,\n      drawing: false,\n      aerisSearchListener: null,\n      aerisResetListener: null,\n      backListener: null,\n      // default temporalExtent\n      temporalExtent: {min: '1900-01-01', max: 'now'}\n    }\n  },\n  watch: {\n    $route (newroute, old) {\n      if (newroute.query.sortBy) {\n        this.sortBy = newroute.query.sortBy\n      } else {\n        this.sortBy = this.$store.state.orderBy\n      }\n//       console.log(newroute)\n//       var oldDepth = old.query.depth ? old.query.depth : 0\n//       var newDepth = newroute.query.depth ? newroute.query.depth : 0\n//       if (newDepth < oldDepth) {\n//         this.back()\n//       } else if (newDepth > oldDepth && !this.currentUuid ){\n//        //  this.$router.replace({name: 'FormaterCatalogue', query:{}})\n//       }\n    }\n  },\n  created () {\n    if (this.$store.state.metadata && this.$route.name !== 'FormaterLogin') {\n      this.$router.replace({name: 'Metadata', params: {uuid: this.$store.state.metadata}})\n      return\n    }\n    // this.$router.push({name: 'FormaterCatalogue'})\n    if (this.$route.query.sortBy) {\n      this.sortBy = this.$route.query.sortBy\n    } else {\n      this.sortBy = this.$store.state.orderBy\n    }\n    \n    this.initTemporalExtent()\n   //  this.$gn.init(this.$i18n.locale, this.$store.state.geonetwork, this.$http, this.$store)\n//     this.metadataListener = this.receiveMetadata.bind(this)\n//     document.addEventListener('fmt:metadataEvent', this.metadataListener);\n//     this.aerisSearchListener = this.handleSearch.bind(this)\n//     document.addEventListener('aerisSearchEvent', this.aerisSearchListener)\n//     this.aerisResetListener = this.handleReset.bind(this)\n//     document.addEventListener('aerisResetEvent', this.aerisResetListener)\n    this.keydownListener = this.checkEscape.bind(this)\n    document.addEventListener('keydown', this.keydownListener)\n\n    // this.resize()\n\n//       var headers =  {\n//           'Accept': 'application/xml'\n//       }\n    \n//     this.$http.get('https://gravi165.step.univ-paris-diderot.fr/geonetwork/srv/api/0.1/records/86a28260-dc26-4b40-8433-9d06e9b9e628', {headers: headers})\n//     .then(resp => console.log(this.displayMeta(resp)))\n//     this.backListener = this.back.bind(this)\n//     window.addEventListener('beforeunload', this.backListener);\n  },\n  mounted () {\n//     var evt = new CustomEvent('fmt:pageChangedEvent')\n//     document.dispatchEvent(evt)\n    if (!this.$store.state.metadata) {\n      // this.$router.push({name: 'FormaterCatalogue', query: {}})\n    }\n    this.$store.commit('services/resetCurrent')\n    this.$store.commit('parametersChange', {parameters: [], mapping: [], fixed: {}, type: null})\n  },\n  destroyed () {\n//     document.removeEventListener('fmt:metadataEvent', this.metadataListener);\n//     this.metadataListener = null;\n    document.removeEventListener('aerisSearchEvent', this.aerisSearchListener)\n    this.aerisSearchListener = null\n    document.removeEventListener('aerisResetEvent', this.aerisResetListener)\n    this.aerisResetListener = null\n\n//     window.removeEventListener('beforeunload', this.backListener);\n//     this.backListener = null\n  },\n  methods: {\n//     displayMeta(obj) {\n//       console.log(obj.body) \n//     },\n\n    initTemporalExtent () {\n      if(this.$store.state.temporalExtent && this.$store.state.temporalExtent.min) {\n        this.temporalExtent.min = this.$store.state.temporalExtent.min\n      }\n      if(this.$store.temporalExtent && this.$store.temporalExtent.max) {\n        this.temporalExtent.max = this.$store.temporalExtent.max\n      }\n    },\n    closeSingle () {\n      var event = new CustomEvent('fmt:closeMetadataEvent', {detail: {depth: 2}})\n      document.dispatchEvent(event)\n      this.$store.commit('resetSelectedMetadata')\n    },\n//     receiveMetadata (event) {\n//       if (this.$store.state.metadata && this.first) {\n//         this.first = false\n//         this.metadataUui = event.detail.meta.id\n//       }\n//       this.metadatas.push(event.detail.meta)\n//       this.currentUuid = event.detail.meta.id\n//       this.$store.commit('currentUuidChange', this.currentUuid)\n//       var min = null\n//       var max = null\n//       var numBegins = 0\n      \n//       if (typeof event.detail.meta.tempExtentBegin === 'string') {\n//         min = event.detail.meta.tempExtentBegin.substring(0, 10)\n//         numBegins = 1\n//       } else if (typeof event.detail.meta.tempExtentBegin === 'object') {\n//         var begins = event.detail.meta.tempExtentBegin.map(function (begin) { return begin.substring(0, 10)})\n//         begins.sort()\n//         min = begins[0]\n//         numBegins = begins.length\n//       } \n//       if (typeof event.detail.meta.tempExtentEnd === 'string' && numBegins === 1) {\n//         max = event.detail.meta.tempExtentEnd.substring(0, 10)\n//       } else if (typeof event.detail.meta.tempExtentEnd === 'object' && event.detail.meta.tempExtentEnd.length === numBegins) {\n//         var ended = event.detail.meta.tempExtentEnd.map(function(end) { return end.substring(0, 10)})\n//         ended.sort()\n//         max = ended[ended.length - 1]\n//       }\n//       var temp = {\n//           min: min ? min : this.temporalExtent.min,\n//           max: max ? max : this.temporalExtent.max\n//       }\n//       this.$store.commit('temporalChange', temp)\n//       this.$router.push({name: 'FormaterCatalogue', query:{uuid:event.detail.meta.id, depth: this.metadatas.length}})\n//     },\n    close () {\n      this.$router.go(-1)\n    },\n    back () {\n      //e.preventDefault()\n      if (this.$store.state.selectedMetadata) {\n        this.$store.commit('resetSelectedMetadata')\n      } else {\n        this.resetMetadata()\n      }\n    },\n    checkEscape (e) {\n        var event = e || window.event\n        var isEscape = false;\n        if (event.key) {\n          isEscape = (event.key === 'Escape' || event.key === 'Esc');\n        } else {\n          isEscape = (event.keyCode === 27);\n        }\n        if (isEscape) {\n           this.$router.go(-1)\n//          this.back()\n//           if (this.$store.state.selectedMetadata) {\n//             this.$store.commit('resetSelectedMetadata')\n//           } else {\n//             this.resetMetadata(e)\n//           }\n        }\n      },\n    resetMetadata () {\n      if (this.metadatas.length === 1 && this.metadatas[0].appRoot) {\n        return\n      }\n      if (this.metadatas.length > 0) {\n        this.metadatas.pop()\n      }\n      if (this.metadatas.length > 0) {\n\n        var metadata = this.metadatas[this.metadatas.length -1]\n        this.currentUuid = metadata.id\n        var type = metadata.disableType\n        var parameters = metadata.osParameters\n        var mapping = metadata.mapping\n        var fixed = metadata.fixed\n        var min = null\n        var max = null\n        if (metadata.tempExtentBegin && metadata.tempExtentBegin.substring) {\n          min = metadata.tempExtentBegin.substring(0, 10)\n        }\n        if (metadata.tempExtentEnd && metadata.tempExtentEnd.substring) {\n          max = metadata.tempExtentEnd.substring(0, 10)\n        }\n        var temp = {\n            min: min ? min : this.temporalExtent.min,\n            max: max ? max : this.temporalExtent.madivx\n        }\n        this.$store.commit('temporalChange', temp)\n      } else {\n        this.currentUuid = null\n        var parameters = []\n        var mapping = []\n        var fixed = {}\n        var type = null\n        this.$store.commit('services/resetCurrent')\n        this.$store.commit('temporalChange', this.temporalExtent)\n      }\n      this.$store.commit('currentUuidChange', this.currentUuid)\n      this.$store.commit('parametersChange', {parameters: parameters, mapping: mapping, fixed: fixed, type: type})\n      var event = new CustomEvent('fmt:closeMetadataEvent', {detail:  {depth: this.metadatas.length }})\n      document.dispatchEvent(event)\n    },\n    setParameters (obj) {\n      if (obj.depth) {\n        this.metadatas[obj.depth - 1].osParameters = obj.osParameters\n        this.metadatas[obj.depth - 1].mapping = obj.mapping\n        this.metadatas[obj.depth - 1].fixed = obj.fixed\n        this.metadatas[obj.depth - 1].disableType = obj.disableType\n      }\n      if (obj.depth === this.metadatas.length) {\n        this.$store.commit('parametersChange', {parameters: obj.osParameters, mapping: obj.mapping, fixed: obj.fixed, type: obj.type})\n      }\n    },\n    registerValues (detail) {\n      if (detail.depth) {\n        this.metadatas[detail.depth - 1].osParameters.forEach( function (parameter) {\n          if (detail.parameters[parameter.name]) {\n            parameter.value = detail.parameters[parameter.name]\n          } else {\n            parameter.value = null\n          }\n        })\n      }\n    },\n\n//     handleReset (event) {\n//    this.$store.commit('resetSelectedMetadata')\n//      if (this.metadatas[0] && this.metadatas[0].appRoot) {\n\n//        event.detail.depth = 1\n//        var metadata = this.metadatas[0]\n//        this.metadatas = this.metadatas.slice(0, 1)\n//        this.currentUuid = this.metadatas[0].id\n//        this.metadatas.length = 1\n//        this.metadatas[0].osParameters.forEach(function (parameter) {\n//            parameter.value = null\n//        })\n//        var parameters = this.metadatas[0].osParameters\n//        var mapping = this.metadatas[0].mapping\n//        var type = this.metadatas[0].disableType\n//        var min = null\n//        var max = null\n//        if (metadata.tempExtentBegin) {\n//          min = metadata.tempExtentBegin.substring(0, 10)\n//        }\n//        if (metadata.tempExtentEnd) {\n//          max = metadata.tempExtentEnd.substring(0, 10)\n//        }\n//        var temp = {\n//            min: min ? min : this.temporalExtent.min,\n//            max: max ? max : this.temporalExtent.max\n//        }\n//        this.$store.commit('temporalChange', temp)\n//        this.$store.commit('currentUuidChange', this.currentUuid)\n//        this.$store.commit('parametersChange', {parameters: parameters, mapping: mapping, type: type})\n\n//      } else {\n//       event.detail.depth = 0\n//       this.metadatas = []\n//       this.metadatas.length = 0\n//       this.currentUuid = null\n//       this.$store.commit('currentUuidChange', this.currentUuid)\n//       this.$store.commit('parametersChange', {parameters: [], mapping: [], type: 'geonetwork'})\n//      }\n//     },\n//     handleSearch (event) {\n//       // mettre plutôt dans formater-metadata ??\n//       if (this.metadatas.length > 0) {\n//         event.detail.parentUuid = this.currentUuid\n//       }\n//     },\n    closeError () {\n      this.$store.commit('removeError')\n    }\n  }\n}\n</script>\n<style>\n\n\n</style>","import mod from \"-!../node_modules/babel-loader/lib/index.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./formater-catalogue.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./formater-catalogue.vue?vue&type=script&lang=js&\"","import mod from \"-!../node_modules/@intlify/vue-i18n-loader/lib/index.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./formater-catalogue.vue?vue&type=custom&index=0&blockType=i18n\"; export default mod; export * from \"-!../node_modules/@intlify/vue-i18n-loader/lib/index.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./formater-catalogue.vue?vue&type=custom&index=0&blockType=i18n\"","import { render, staticRenderFns } from \"./formater-catalogue.vue?vue&type=template&id=0852f41c&\"\nimport script from \"./formater-catalogue.vue?vue&type=script&lang=js&\"\nexport * from \"./formater-catalogue.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* custom blocks */\nimport block0 from \"./formater-catalogue.vue?vue&type=custom&index=0&blockType=i18n\"\nif (typeof block0 === 'function') block0(component)\n\nexport default component.exports"],"names":["module","exports","Component","options","__i18n","push","_Ctor","component","_c","this","_self","_vm","staticClass","_v","_s","metaDisplayed","attrs","$store","state","searching","$t","_e","error","on","closeError","selectedMetadata","$event","closeSingle","directives","name","rawName","value","metadatas","length","expression","sortBy","_l","meta","index","key","setParameters","close"],"sourceRoot":""}
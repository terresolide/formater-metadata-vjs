(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{372:function(t,e,r){"use strict";r.r(e);var a={name:"FormaterOpensearch",props:{describe:{type:String,default:null},uuid:{type:String,default:null},depth:{type:Number,default:null}},created:function(){this.searchEventListener=this.handleSearch.bind(this),document.addEventListener("aerisSearchEvent",this.searchEventListener),this.load()},mounted:function(){},destroyed:function(){document.removeEventListener("aerisSearchEvent",this.searchEventListener),this.searchEventListener=null},data:function(){return{searchEventListener:null,api:null,mappingParameters:[],osParameters:[]}},methods:{load:function(){var t=this;this.$http.get(this.describe).then((function(e){t.extractDescribeParameters(e.body)}),(function(e){t.loadWithProxy()}))},loadWithProxy:function(){var t=this;if(this.$store.state.proxy.url){var e=this.$store.state.proxy.url+"?url="+encodeURIComponent(this.describe);this.$http.get(e).then((function(e){t.extractDescribeParameters(e.body)}))}else console.log("CAN NOT GET "+this.describe)},extractParameter:function(t,e){var r=function(t,e){return Object.keys(t).find((function(r){return t[r]===e}))}(this.$store.state.parameters.predefined,e),a=t.getAttribute("name");if(void 0===r){var i={name:a,title:t.getAttribute("title")};switch(a){case"relativeOrbitNumber":i.title=i.title||"Ex: 123"}var n=t.getAttribute("pattern");n&&(i=Object.assign(i,{pattern:n}));var s=t.getAttribute("minInclusive");s&&(i=Object.assign(i,{min:s}));var o=t.getAttribute("maxInclusive");o&&(i=Object.assign(i,{max:o}));var u=t.getElementsByTagName("parameters:Options");if(u){for(var c=[],h=0;h<u.length;h++)c.push(u[h].getAttribute("value"));c.length>0&&(i=Object.assign(i,{options:c}))}(!i.options||i.options.length>1)&&this.osParameters.push(i)}else this.mappingParameters[r]=a},extractDescribeParameters:function(t){var e=null;if((new DOMParser).parseFromString(t,"text/xml").firstChild.childNodes.forEach((function(t){if(t.tagName&&"url"===t.tagName.toLowerCase()&&t.getAttribute("type").indexOf("json")>=0){var r=t.getAttribute("template").match(/^(.*(?:(?:search.json\?)|(?:\?format=FLATSIM))).*$/);r&&r[1]&&""!=r[1]&&(e=t)}})),e){var r=e.getAttribute("template").match(/^(.*(?:(?:search.json\?)|(?:\?format=FLATSIM))).*$/);if(r[1]){this.api=r[1];for(var a=e.getElementsByTagName("parameters:Parameter"),i=this.$store.state.parameters.excluedRegex,n=0;n<a.length;n++){var s=a[n].getAttribute("value");i.some((function(t){return new RegExp(t).test(s)}))||this.extractParameter(a[n],s)}this.$emit("parametersChange",{api:this.api,parameters:this.osParameters,mapping:this.mappingParameters})}}},handleSearch:function(t){this.api&&t.detail.parentUuid===this.uuid&&(t.detail.api=this.api)}}},i=r(1),n=Object(i.a)(a,(function(){var t=this.$createElement;return(this._self._c||t)("div")}),[],!1,null,null,null);e.default=n.exports}}]);
//# sourceMappingURL=11.formater-metadata-vjs.js.map